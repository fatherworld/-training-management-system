# 🚀 培训管理系统 - 免费部署指南

## 部署架构

- **后端API**: Railway (免费额度 500小时/月)
- **前端网站**: Netlify (免费额度 100GB流量/月)
- **数据库**: SQLite (随后端部署)

## 一、后端部署到Railway

### 1. 注册Railway账号
1. 访问 [railway.app](https://railway.app)
2. 使用GitHub账号注册/登录

### 2. 部署后端
1. 点击 "New Project" → "Deploy from GitHub repo"
2. 选择这个项目仓库
3. Railway会自动检测到Node.js项目
4. 等待部署完成（约2-3分钟）

### 3. 配置环境变量
在Railway项目的Variables标签页添加：
```
PORT=5000
NODE_ENV=production
JWT_SECRET=training_management_secret_key_2024
```

### 4. 获取部署URL
- 部署完成后，在Railway控制台可以看到分配的URL
- 格式类似：`https://your-app-name.railway.app`
- 记下这个URL，后面配置前端时需要用到

## 二、前端部署到Netlify

### 1. 注册Netlify账号
1. 访问 [netlify.com](https://netlify.com)
2. 使用GitHub账号注册/登录

### 2. 配置环境变量
1. 编辑 `src/client/env.production` 文件
2. 将 `your-railway-app.railway.app` 替换为Railway实际分配的域名：
```
REACT_APP_API_URL=https://实际的railway域名.railway.app/api
GENERATE_SOURCEMAP=false
```

### 3. 部署前端
1. 在Netlify控制台点击 "New site from Git"
2. 选择GitHub仓库
3. 配置构建设置：
   - **Base directory**: `src/client`
   - **Build command**: `npm run build`
   - **Publish directory**: `src/client/build`
4. 点击 "Deploy site"

### 4. 配置环境变量（Netlify）
在Netlify项目的Environment variables中添加：
```
REACT_APP_API_URL=https://实际的railway域名.railway.app/api
```

## 三、完成部署

### 1. 更新CORS配置
1. 获取Netlify分配的域名（如：`https://amazing-app-123456.netlify.app`）
2. 登录Railway，在项目环境变量中添加：
```
CLIENT_URL=https://你的netlify域名.netlify.app
```

### 2. 测试系统
1. 访问Netlify提供的前端地址
2. 使用默认账号登录：
   - 用户名：`admin`
   - 密码：`admin123`

## 四、自定义域名（可选）

### Railway自定义域名
1. 在Railway项目设置中点击 "Custom Domain"
2. 添加你的域名（需要先在域名提供商处添加CNAME记录）

### Netlify自定义域名
1. 在Netlify项目设置中点击 "Domain settings"
2. 添加自定义域名并配置DNS

## 五、监控和维护

### Railway监控
- 在Railway控制台可以查看：
  - 应用状态和日志
  - 资源使用情况
  - 部署历史

### Netlify监控
- 在Netlify控制台可以查看：
  - 构建状态和日志
  - 访问统计
  - 表单提交（如果使用）

## 六、费用说明

### Railway免费额度
- 500小时运行时间/月
- 1GB RAM
- 1GB存储空间
- 一个项目

### Netlify免费额度
- 100GB流量/月
- 300分钟构建时间/月
- 无限静态网站

## 七、故障排除

### 常见问题

**1. 后端部署失败**
- 检查package.json依赖是否正确
- 查看Railway部署日志
- 确认Node.js版本兼容性

**2. 前端无法连接后端**
- 检查REACT_APP_API_URL环境变量
- 确认Railway后端正常运行
- 检查CORS配置

**3. 数据库问题**
- SQLite数据库会自动创建
- 数据持久化依赖Railway存储
- 如需备份，定期导出数据库

### 日志查看
- **Railway**: 项目控制台 → Logs标签
- **Netlify**: 项目控制台 → Functions/Deploys标签

## 八、升级和扩展

### 数据库升级
如果数据量增大，可以考虑：
1. 升级到Railway Pro（PostgreSQL）
2. 使用PlanetScale（免费MySQL）
3. 迁移到Supabase（免费PostgreSQL）

### 性能优化
1. 启用Netlify CDN
2. 压缩静态资源
3. 实施缓存策略

---

🎉 **部署完成！你的培训管理系统现在可以全球访问了！**

如有问题，请检查各平台的控制台日志进行排查。

